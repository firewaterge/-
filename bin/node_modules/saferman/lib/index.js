const mysql = require('mysql');
let pool;

let saferman = module.exports = function saferman(password){
    if(password){
        pool = mysql.createPool({
            connectionLimit : 100,
            host : '127.0.0.1',
            user : 'root',
            password : password,
            database : 'QuestionSystem'
        });
    }

    return saferman;
};

saferman.sql = function(sql,callback){
    //console.log('saferman.sql: '+sql);
    pool.query(sql,function(err,results){
        //console.log('saferman.sql: results is: '+results.length);
        if(err){
            console.log(err);
            console.log(err.stack);
        };

        if(callback != undefined){
            //console.log('saferman.sql: execute callback');
            callback(results);
        }
    });
}

saferman.format = function(sql,arr){
    //console.log('saferman.format execute');
    var sql_string = mysql.format(sql,arr);
    return sql_string;
}
